<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>生物記憶卡</title>
<style>
  :root{ /* 預設主題：深紫色 */
    --primary:#5a4fcf;
    --primary-2:#8f7ce8;
    --bg-1:#667eea;
    --bg-2:#764ba2;
    --card-1:#a18cd1;
    --card-2:#fbc2eb;
    --front-1:#c3aed6;
    --front-2:#f7d6e0;
    --back-1:#6a3093;
    --back-2:#a044ff;
    --text:#2c2c54;
    --text-inv:#f0e9ff;
    --shadow-1: rgba(90, 79, 207, 0.7);
    --shadow-2: rgba(143, 124, 232, 0.9);
  }
  /* --- 新增：定義多套顏色主題 --- */
  :root.theme-ocean-blue { /* 主題2：海洋藍 */
    --primary: #0077b6; --primary-2: #0096c7; --bg-1: #005f73; --bg-2: #0a9396;
    --card-1: #94d2bd; --card-2: #e9d8a6; --front-1: #e9f5db; --front-2: #cfe8e0;
    --back-1: #001219; --back-2: #005f73; --text: #001219; --text-inv: #e9f5db;
    --shadow-1: rgba(0, 119, 182, 0.7); --shadow-2: rgba(0, 150, 199, 0.9);
  }
  :root.theme-sunset-glow { /* 主題3：日落霞光 */
    --primary: #e76f51; --primary-2: #f4a261; --bg-1: #e15f41; --bg-2: #e76f51;
    --card-1: #f4a261; --card-2: #e9c46a; --front-1: #fff8f0; --front-2: #fefae0;
    --back-1: #d62828; --back-2: #f77f00; --text: #264653; --text-inv: #ffffff;
    --shadow-1: rgba(231, 111, 81, 0.7); --shadow-2: rgba(244, 162, 97, 0.9);
  }
  :root.theme-forest-green { /* 主題4：森林綠 */
    --primary: #2d6a4f; --primary-2: #40916c; --bg-1: #1b4332; --bg-2: #2d6a4f;
    --card-1: #74c69d; --card-2: #b7e4c7; --front-1: #d8f3dc; --front-2: #ffffff;
    --back-1: #081c15; --back-2: #1b4332; --text: #081c15; --text-inv: #d8f3dc;
    --shadow-1: rgba(45, 106, 79, 0.7); --shadow-2: rgba(64, 145, 108, 0.9);
  }
  /* --- 主題定義結束 --- */

  *{box-sizing:border-box}
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, var(--bg-1), var(--bg-2));
    margin: 0; padding: 0;
    min-height: 100vh;
    display: flex; flex-direction: column; align-items: center;
    color: #f0f0f0;
    transition: background 0.5s ease;
  }
  header {
  /* 大部分樣式不變，主要是修改排版方式 */
  background: linear-gradient(90deg, var(--primary), var(--primary-2));
  width: 100%;
  padding: 1.1rem 1rem;
  font-size: 1.2rem;
  font-weight: 700;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  position: sticky; top: 0; z-index: 10;
  transition: background 0.5s ease;

  /* 以下是修改和新增的部分 */
  display: flex;
  justify-content: center; /* 讓內容水平置中 */
  align-items: center;    /* 讓內容垂直置中 */
  position: relative;     /* 為了讓返回按鈕能定位 */
}
.back-link {
  position: absolute; /* 絕對定位，讓它脫離正常的排版流 */
  left: 15px;         /* 定位在 header 左邊 15px 的位置 */
  top: 50%;           /* 垂直置中 */
  transform: translateY(-50%); /* 確保精確垂直置中 */

  color: var(--text-inv);
  text-decoration: none;
  font-size: 0.9rem;
  font-weight: 500;
  background: rgba(255, 255, 255, 0.15);
  padding: 8px 12px;
  border-radius: 8px;
  transition: background 0.2s;
}

.back-link:hover {
  background: rgba(255, 255, 255, 0.3);
}
  main {
    flex: 1; width: 100%; max-width: 520px;
    padding: 1rem 1rem 1.5rem;
    display: flex; flex-direction: column; align-items: center; gap: .75rem;
  }
  .chapters {
    width: 100%; display: flex; gap: .5rem;
    overflow-x: auto; -webkit-overflow-scrolling: touch; padding-bottom: .25rem;
  }
  .chapters::-webkit-scrollbar{height:6px}
  .chapters::-webkit-scrollbar-thumb{background:rgba(255,255,255,.3);border-radius:6px}
  .tab {
    white-space: nowrap; background: rgba(255,255,255,0.15); color: #fff;
    border: 1px solid rgba(255,255,255,0.25); padding: .45rem .75rem;
    border-radius: 999px; cursor: pointer; transition: all .25s; font-size: .95rem;
  }
  .tab:hover { background: rgba(255,255,255,0.25); }
  .tab.active {
    background: #ffce6b; color: #2b2b2b; border-color: #ffce6b;
    box-shadow: 0 2px 10px rgba(255,206,107,0.45);
  }
  #flashcardPage {
    flex-direction: column; align-items: center; display: flex; width: 100%;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .card-container {
    perspective: 1000px; width: 100%; height: 240px; outline: none;
    animation: fadeIn 0.4s ease-out;
  }
  .card {
    width: 100%; height: 240px; position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s, background 0.5s ease;
    cursor: pointer; border-radius: 16px;
    background: linear-gradient(135deg, var(--card-1), var(--card-2));
    box-shadow: 0 8px 20px rgba(0,0,0,0.3); color: var(--text);
    display: flex; justify-content: center; align-items: center;
    padding: 1.25rem; font-size: 1.05rem; line-height: 1.45;
    user-select: none; text-align: left; white-space: pre-wrap;
  }
  .card.flipped { transform: rotateY(180deg); }
  .card-face {
    position: absolute; width: 100%; height: 100%; border-radius: 16px;
    backface-visibility: hidden; display: flex; justify-content: center;
    align-items: flex-start; padding: 1.25rem; box-sizing: border-box;
    overflow-y: auto;
    transition: background 0.5s ease, color 0.5s ease;
  }
  .card-front { background: linear-gradient(135deg, var(--front-1), var(--front-2)); color: var(--text); }
  .card-back { transform: rotateY(180deg); background: linear-gradient(135deg, var(--back-1), var(--back-2)); color: var(--text-inv); }
  #cardNumber { margin-top: 0.4rem; font-size: 0.9rem; color: #e9e6ff; text-align: center; }
  .footer { margin-top: 1rem; width: 100%; display: flex; flex-direction: column; align-items: center; gap: .4rem; }
  .button-row { display: flex; justify-content: center; gap: .6rem; flex-wrap: wrap; width: 100%; }
  button {
    background: var(--primary); border: none; color: white;
    padding: 0.5rem 0.9rem; font-size: 1rem; border-radius: 10px; cursor: pointer;
    transition: background 0.25s, transform .05s, box-shadow 0.25s;
    min-width: 88px;
    box-shadow: 0 4px 10px var(--shadow-1);
  }
  button:hover:not(:disabled) {
    background: var(--primary-2); box-shadow: 0 6px 14px var(--shadow-2);
  }
  button:active:not(:disabled){ transform: translateY(1px); }
  button:disabled { background: #a0aabe; cursor: default; box-shadow: none; color: #eee; }
  #summaryBlock {
    margin-top: 0.9rem; background: rgba(0,0,0,0.35); padding: 1rem; border-radius: 12px;
    max-height: 340px; overflow-y: auto; width: 100%; text-align: left;
    transition: all 0.4s ease-out; transform: translateY(20px); opacity: 0;
  }
  #summaryBlock:not([hidden]) { transform: translateY(0); opacity: 1; }
  #summaryBlock h3 { margin: 0 0 .5rem 0; color: var(--text-inv); font-size: 1.05rem; }
  #summaryBlock .summary-item { margin-bottom: .8rem; background: rgba(255,255,255,0.08); padding: .6rem .7rem; border-radius: 10px; }
  #summaryBlock .summary-item p { margin: 0.2rem 0; }
  .toolbar { width: 100%; display: flex; justify-content: space-between; align-items: center; gap: .6rem; flex-wrap: wrap; }
  .pill { font-size: .9rem; color: #fff; background: rgba(255,255,255,.15); padding: .35rem .6rem; border-radius: 999px; }
  @media (max-width: 520px) {
    .card { height: 210px; font-size: 1rem; padding: 1rem; }
    .card-face { padding: 1rem; }
  }
</style>
</head>
<body>
<header>
  <a href="index.html" class="back-link">🔙 返回目錄</a>
  <span id="headerTitle">CH1 生物學入門</span>
</header>
<main>
  <nav class="chapters" aria-label="章節切換">
    <button class="tab active" data-chapter="CH5" aria-pressed="true">CH5</button>
    <button class="tab" data-chapter="CH6" aria-pressed="false">CH6</button>
    <button class="tab" data-chapter="CH7" aria-pressed="false">CH7</button>
    <button class="tab" data-chapter="CH8" aria-pressed="false">CH8</button>
  </nav>
  <div class="toolbar">
    <span id="chapterInfo" class="pill">目前章節：CH11</span>
    <button id="themeBtn" aria-label="切換主題" style="min-width: auto; padding: 0.4rem 0.7rem;">🎨 切換主題</button>
    <span class="pill">操作提示：點卡片或按空白鍵翻轉</span>
  </div>
  <section id="flashcardPage" aria-live="polite" aria-atomic="true">
    <div class="card-container" tabindex="0" aria-label="抽認卡，點擊或按空白鍵翻轉">
      <div id="card" class="card" role="button" aria-pressed="false" tabindex="0">
        <div id="cardFront" class="card-face card-front"></div>
        <div id="cardBack" class="card-face card-back"></div>
      </div>
      <div id="cardNumber" aria-live="polite" aria-atomic="true"></div>
    </div>
    <div class="footer">
      <div class="button-row" id="firstRow">
        <button id="flipBtn" aria-label="翻轉卡片">🔄 翻轉</button>
        <button id="hardBtn" aria-label="困難">🤔 困難</button>
        <button id="mediumBtn" aria-label="一般">🙂 一般</button>
        <button id="easyBtn" aria-label="容易">😄 容易</button>
      </div>
      <div class="button-row" id="secondRow">
        <button id="prevBtn" aria-label="上一題" disabled>⬅️ 上一題</button>
        <button id="summaryBtn" aria-label="困難題目小結">📝 困難小結</button>
      </div>
    </div>
    <div id="summaryBlock" aria-live="polite" aria-atomic="true" hidden></div>
  </section>
</main>
<script>
// =================================================
// Local Storage 功能區塊
// =================================================

// 函式：儲存所有進度到 localStorage
function saveProgress() {
  // 建立一個物件來存放需要儲存的資料
  const dataToSave = {
    stateByChapter: stateByChapter,       // 儲存每個章節的學習狀態
    currentChapterId: currentChapterId,   // 儲存最後所在的章節ID
    currentThemeIndex: currentThemeIndex  // 儲存主題樣式的索引
  };
  
  // 將物件轉換為 JSON 文字格式並儲存
  localStorage.setItem('flashcardProgress', JSON.stringify(dataToSave));
}

// 函式：從 localStorage 讀取並應用所有進度
function loadProgressAndSettings() {
  const savedDataJSON = localStorage.getItem('flashcardProgress');
  
  if (savedDataJSON) { // 檢查是否有儲存過資料
    try {
      const savedData = JSON.parse(savedDataJSON);
      
      // 讀取學習進度
      if (savedData.stateByChapter) {
        Object.assign(stateByChapter, savedData.stateByChapter);
      }
      
      // 讀取上次章節
      if (savedData.currentChapterId) {
        currentChapterId = savedData.currentChapterId;
      }
      
      // 讀取主題
      if (typeof savedData.currentThemeIndex !== 'undefined') {
        currentThemeIndex = savedData.currentThemeIndex;
        docElem.className = themes[currentThemeIndex];
      }
    } catch (e) {
      console.error("讀取 localStorage 資料時出錯:", e);
      // 如果資料格式錯誤，可以選擇清除它
      // localStorage.removeItem('flashcardProgress');
    }
  }
}

// =================================================
// Local Storage 功能區塊結束
// =================================================

  // 章節資料定義
  const chapters = [
    // ... (所有 chapters 的資料和之前一樣，此處省略以節省篇幅) ...
    {
      id: "CH5",
      title: "生物記憶卡_CH5 食物和人類",
      flashcards: [
      { question: "什麼是均衡飲食？", answer: "均衡飲食是指攝取適量且多樣化的食物，包含所有必需營養素，以滿足人體健康需求。\n\n解釋：常誤以為均衡飲食僅指多吃蔬菜，忽略了營養素的均衡性。" },
      { question: "人體必需的七大營養素是什麼？", answer: "碳水化合物、蛋白質、脂質、維生素、礦物質、膳食纖維、水。" },
      { question: "蛋白質在人體中的作用有哪些？", answer: "生長修復組織、製造酶和激素、提供能量（這點次要）。" },
      { question: "脂質的食物來源有哪些？", answer: "動物脂肪（如奶油）、植物油、堅果、魚類。" },
      { question: "維生素C的主要功能是什麼？", answer: "促進傷口癒合、增強免疫力。" },
      { question: "維生素A缺乏會導致什麼健康問題？", answer: "夜盲症。" },
      { question: "什麼是DCPIP試驗？", answer: "DCPIP試驗用於檢測食物中的維生素C，溶液從藍色褪色至無色表示存在維生素C。當中所使用的維生素C(滴數)愈多代表維生素C的濃度愈低（適用於其他食物樣本）。" },
      { question: "為什麼素食者需要多吃豆類製品？", answer: "豆類提供蛋白質，補充素食飲食中可能缺乏的必需氨基酸。肉類為食物中多數的蛋白質來源。" },
      { question: "維生素C在烹調中的穩定性如何？", answer: "維生素C易被高溫破壞，沸水烹煮會顯著降低含量。" },
      { question: "過量攝取脂質可能導致什麼健康問題？", answer: "肥胖、心血管疾病。" },
      { question: "許多人認為呼吸就是細胞呼吸，這種說法正確嗎？", answer: "不正確。呼吸是指生物體與外界進行氣體交換的過程，而細胞呼吸是一個在所有活細胞內進行的化學反應，涉及葡萄糖分解以釋放能量，兩者概念不同。" },
      { question: "在營養學中，澱粉、葡萄糖和蔗糖都屬於碳水化合物，它們之間有什麼主要區別？", answer: "葡萄糖是單糖，是碳水化合物最簡單的形式，可直接被吸收利用；蔗糖是雙糖，由葡萄糖和果糖組成，需分解為單糖才能吸收；澱粉則是多糖，由許多葡萄糖單元組成，需要更複雜的消化過程才能被分解成單糖。" },
      { question: "有些人認為膳食纖維不提供能量，所以對人體沒有重要性，這種看法正確嗎？", answer: "不正確。儘管膳食纖維本身不提供能量，但它在維持消化系統健康、增加飽足感、促進腸道蠕動和預防某些疾病方面扮演著重要角色。" },
      { question: "在食物測試中，進行本立德試驗時，如果溶液沒有變成磚紅色沉澱，就一定表示沒有糖嗎？", answer: "不一定。本立德試驗只能檢測還原糖，如葡萄糖、果糖和麥芽糖。如果食物中只含有非還原糖，如蔗糖，本立德試驗結果會是藍色。" },
      { question: "有人說植物是從泥土中獲取食物來生長的，這種說法正確嗎？", answer: "不正確。植物主要通過光合作用自行製造食物（葡萄糖），它們從空氣中吸收二氧化碳，並利用光能和水。泥土主要為植物提供生長所需的礦物質和水分，而非食物本身。" },
      { question: "人體所需的營養素可以簡單分為「多吃才好」和「少量即可」兩種嗎？", answer: "這個分類過於簡化。人體所需的營養素可分為基本食物物質（如碳水化合物、蛋白質、脂質，需要大量攝取以提供能量和建構身體），以及保護性食物物質（如維生素和礦物質，雖然需求量小，但對於維持身體正常代謝和預防疾病至關重要）。" },
      { question: "純素飲食者需要特別組合植物性食物，才能攝取到所有「完整」的必需氨基酸，這種說法正確嗎？", answer: "這是一個常見的誤解。大多數植物性食物都含有所有九種必需氨基酸，只是某些氨基酸的含量可能較低。只要純素飲食者攝取多樣化的植物性食物，通常都能滿足身體對必需氨基酸的需求，無需刻意在同一餐中組合。" },
      { question: "什麼是「必需氨基酸」？它們與「非必需氨基酸」有什麼不同？", answer: "必需氨基酸是指人體無法自行合成，必須從食物中攝取的氨基酸。非必需氨基酸則是人體可以自行合成的氨基酸。" },
      { question: "水不提供能量，因此在營養攝入方面它的重要性不及其他基本食物物質，這種說法正確嗎？", answer: "不正確。雖然水不提供能量，但它是維持生命活動不可或缺的物質，參與體內所有化學反應，調節體溫，運輸營養素和廢物，並維持細胞和組織的正常結構。" },
      { question: "為了減肥，完全避免攝取脂肪是最佳選擇嗎？", answer: "不正確。脂肪是重要的基本食物物質之一，為身體提供能量、幫助吸收脂溶性維生素（A、D），並有助於維持細胞膜結構和保暖。應選擇攝取健康的脂肪（如不飽和脂肪），而非完全避免所有脂肪。" },
      { question: "青少年和老年人的膳食需求有什麼區別？", answer: "青少年處於快速生長發育階段，需要更多能量和蛋白質來支持生長和組織修復。老年人則可能因為新陳代謝減慢、活動量減少和消化吸收能力下降，需要較少的總能量，但仍需足夠的蛋白質、維生素和礦物質來維持肌肉量和骨骼健康。" },
      { question: "有什麼多糖的例子？", answer: "澱粉、糖原、纖維素" },
      { question: "有什麼雙糖的例子？", answer: "麥芽糖、乳糖、蔗糖" },
      { question: "有什麼單糖的例子？", answer: "葡萄糖、半乳糖、果糖" },
      { question: "碳水化合物由什麼元素組成？", answer: "碳、氫、氧" },
      { question: "蛋白質由什麼元素組成？", answer: "碳、氫、氧、氮" },
      { question: "脂質由什麼元素組成？", answer: "碳、氫、氧" }
    ]
    },
    {
    id: "CH6",
    title: "生物記憶卡_CH6 人的營養",
    flashcards: [
      { question: "自養營養與異養營養的區別是什麼？", answer: "自養營養指生物能自行製造食物，異養營養則依賴其他生物獲取食物。" },
      { question: "舉出腐生營養的例子？", answer: "腐生營養的例子包括真菌和某些細菌，它們分解死去的有機物，如生物殘骸。" },
      { question: "有哪兩種消化模式？", answer: "物理消化和化學消化。" },
      { question: "什麼是物理消化？", answer: "物理消化是利用物理過程將食物變成小塊的過程，不改變其化學結構。" },
      { question: "什麼是化學消化？", answer: "化學消化是利用消化酶將大分子分解成小分子的化學反應。" },
      { question: "小腸的結構有什麼適應性特徵？", answer: "小腸很長，增加食物逗留時間。內壁高度摺叠，並有大量絨毛和微絨毛，增加吸收的表面積。小腸壁和微血管很簿（僅由一層上皮細胞組成），能縮短已消化的食物分子的擴散距。有大量的血管和乳糜管存在，能迅速將已吸收的食物運走，保持陡峭的濃度梯度。" },
      { question: "唾液的作用是什麼？", answer: "唾液含有唾液澱粉酶，能催化澱粉分解為麥芽糖。" },
      { question: "胃液的主要成分是什麼？", answer: "胃液包含胃蛋白酶和氫氯酸，胃蛋白酶消化蛋白質成氨基酸，氫氯酸則提供合適pH讓胃蛋白酶催化消化。" },
      { question: "膽汁的功能是什麼？", answer: "膽汁乳化脂質成小油滴，提供更大的表面積讓脂肪酶進行化學消化，促進脂肪消化成甘油和脂肪酸。" },
      { question: "胰液的主要作用是什麼？", answer: "胰液含有多種消化酶，能分解碳水化合物、脂質和蛋白質。包括胰澱粉酶消化澱粉成麥芽糖、胰脂肪酶消化脂質成甘油和脂肪酸和胰蛋白酶消化多肰成氨基酸。" },
      { question: "吸收的過程主要在哪個部位進行？", answer: "吸收主要在小腸的迴腸進行。" },
      { question: "單糖和氨基酸如何被吸收？", answer: "單糖和氨基酸通過微血管進入血液。" },
      { question: "脂肪酸和甘油的吸收過程是什麼？", answer: "脂肪酸和甘油進入絨毛的上皮細胞後，重新合成為脂質，然後進入乳糜管。" },
      { question: "肝的主要功能有哪些？", answer: "肝主要負責代謝、儲存糖原、分解過多氨基酸和解毒。" },
      { question: "過剩的葡萄糖如何處理？", answer: "過剩的葡萄糖轉化為糖原儲存在肝和肌肉中。" },
      { question: "氨基酸的去向是什麼？", answer: "氨基酸用於合成蛋白質，或在缺乏能量時釋放能量。過多的氨基酸不會儲存，會在肝中進行脫氨作用。" },
      { question: "小腸的微絨毛有什麼作用？", answer: "微絨毛增加吸收表面積，促進食物分子的吸收。" },
      { question: "消化系統中蠕動的作用是什麼？", answer: "蠕動幫助推進食物，並促進與消化液的混合。" },
      { question: "為什麼需要增加食物的表面積？", answer: "增加食物的表面積能促進消化液的接觸，提高化學消化效率。" },
      { question: "為什麼消化液的pH值對消化過程重要？", answer: "不同酶在特定pH值下活性最高，影響食物的消化效率。" },
      { question: "膽汁在消化過程中的主要作用是什麼？它是否包含消化酶？", answer: "膽汁的主要作用是乳化脂肪（物理消化），將大脂肪球分解成小油滴，增加脂肪酶的作用表面積。膽汁不含消化酶，因此不參與化學消化。" },
      { question: "牙齒最外層的琺瑯質受損後能否再生？", answer: "不能。琺瑯質是人體最堅硬的物質，但一旦受損或被酸腐蝕，身體無法自行再生。" },
      { question: "澱粉的化學消化從消化道的哪個部位開始？", answer: "澱粉的化學消化始於口腔。唾液中的唾液澱粉酶會將澱粉分解成較小的糖分子。" },
      { question: "蛋白質的化學消化從消化道的哪個部位開始？", answer: "蛋白質的化學消化始於胃。胃液中的胃蛋白酶在酸性環境下開始分解蛋白質。" },
      { question: "脂質的化學消化從消化道的哪個部位開始？", answer: "脂質的化學消化主要在小腸中進行，由胰液的脂肪酶和小腸上皮細胞上的脂肪酶完成。" },
      { question: "列出人體營養的五個主要過程。", answer: "攝食、消化、吸收、同化  和排遺。" },
      { question: "物理消化和化學消化有什麼區別？", answer: "物理消化是將食物大塊地粉碎成小塊，增加表面積，例如咀嚼和胃的攪拌。化學消化是利用酶將食物中的大分子分解成小分子。" },
      { question: "胃蛋白酶在哪種pH值環境下活性最佳？", answer: "胃蛋白酶在強酸性環境（低pH值，約1.5-3.5）下活性最佳，這是由胃分泌的胃酸提供的。" },
      { question: "為什麼食物必須經過消化才能被身體吸收？", answer: "食物中的許多分子太大，無法直接穿過細胞膜進入血液。消化將這些大分子分解成足夠小的單位，才能被吸收。" },
      { question: "人類有幾種不同類型的牙齒？它們的主要功能是什麼？", answer: "人類有四種不同類型的牙齒：門齒（切割）、犬齒（撕裂）、前臼齒（磨碎）、臼齒（磨碎）。" },
      { question: "胃液的成分除了胃蛋白酶還有什麼？它們各有什么作用？", answer: "胃液還包含氫氯酸（提供酸性環境供胃蛋白酶作用、殺菌）和黏液（保護胃壁免受胃酸腐蝕）。" },
      { question: "胰液中含有哪些主要的消化酶？它們各自作用於哪種食物分子？", answer: "胰液含有胰澱粉酶（消化碳水化合物）、胰脂肪酶（消化脂質）和胰蛋白酶（消化蛋白質）。" },
      { question: "吞嚥食物時，什麼結構可以防止食物進入氣管？", answer: "會厭在吞嚥時會下蓋，阻止食物進入氣管，確保食物進入食道。" },
      { question: "消化酶的活性會受到哪些因素的影響？", answer: "消化酶的活性主要受溫度和pH值影響。超出最適合的溫度或pH範圍，酶的結構可能改變（變性），從而失去活性。" },
      { question: "唾液除了含有澱粉酶外，還有哪些成分？它們有什麼作用？", answer: "唾液還含有黏液（潤滑食物，便於吞嚥）和水（濕潤食物，溶解可溶性物質）。" },
      { question: "人體在什麼時候開始從食物中吸收營養？", answer: "大部分營養物質的吸收發生在小腸，特別是小腸多度摺疊及小腸中的絨毛和微絨毛大大增加了吸收食物的表面積。" },
      { question: "什麼是恆齒和乳齒？它們的數量有何不同？", answer: "乳齒是人類幼兒期生長的第一套牙齒，通常有20顆。恆齒是成年後取代乳齒的牙齒，通常有32顆（包括智齒）。" },
      { question: "膽囊的功能是什麼？它是否產生膽汁？", answer: "膽囊的功能是儲存膽汁，但膽汁是由肝臟產生的。" },
      { question: "為什麼食物中的大分子（如澱粉、蛋白質）不能直接被細胞吸收？", answer: "這些大分子無法直接穿過細胞膜。細胞膜是差異透性膜，只允許小分子物質通過。因此，大分子需要先被消化酶分解成小分子才能被吸收。" },
      { question: "消化腺包括哪些腺體？", answer: "唾液腺、胃腺、胰腺、肝臟、腸腺。留意，肝臟是消化腺，因為會分泌膽汁作物理消化。" },
      { question: "牙齒在消化中的作用是什麼？", answer: "進行物理消化，牙齒通過咀嚼將食物機械分解成小塊，增加與消化液的接觸面積。" },
      { question: "人類的四種牙齒類型及其功能是什麼？", answer: "門齒（切斷食物）、犬齒（撕裂食物）、前臼齒（磨碎食物）、臼齒（磨碎食物）。" },
      { question: "什麼是齒式？", answer: "齒式是表示哺乳動物牙齒數目和排列方式的公式。" },
      { question: "人類的乳齒和恆齒齒式分別是什麼？", answer: "乳齒：2.1.0.2/2.1.0.2；恆齒：2.1.2.3/2.1.2.3。" },
      { question: "牙齒的結構包括哪些部分？", answer: "琺瑯質、牙本質、髓腔、牙骨質。" },
      { question: "蛀牙是如何形成的？", answer: "細菌在牙齒上形成牙菌斑，分解食物殘渣產生酸，酸腐蝕牙齒表面形成蛀牙。\n\n留意，蛀牙並非單純由糖引起，需理解細菌分解糖才會出現酸性物質引致蛀牙。" },
      { question: "蠕動有什麼重要性？", answer: "幫助食物移動、混合食物與消化液、增加消化道壁與食物的接觸。" },
      { question: "消化分為哪兩種類型？", answer: "機械消化和化學消化。" },
      { question: "機械消化的例子有哪些？", answer: "咀嚼、蠕動、胃的攪動、膽鹽乳化脂質。" },
      { question: "化學消化的例子有哪些？", answer: "唾液澱粉酶分解澱粉、胃蛋白酶分解蛋白質、胰澱粉酶消化澱粉成麥芽糖、胰脂肪酶消化脂質成甘油和脂肪酸和胰蛋白酶消化多肰成氨基酸。。" },
      { question: "口腔中的消化過程是什麼？", answer: "機械消化（咀嚼）和化學消化（唾液澱粉酶分解澱粉成麥芽糖）。" },
      { question: "食道中的消化過程是什麼？", answer: "只有機械消化（蠕動），無化學消化。" },
      { question: "胃中的消化過程是什麼？", answer: "機械消化（攪動）和化學消化（胃蛋白酶分解蛋白質）。" },
      { question: "十二指腸中的消化過程是什麼？", answer: "機械消化（膽鹽乳化脂質）和化學消化（胰液中的酶分解營養素）。" },
      { question: "小腸中的消化過程是什麼？", answer: "主要為化學消化（小腸上皮細胞表面的碳水化合物酶分解碳水化合物成單糖和蛋白酶分解多肰成氨基酸）和吸收。\n\n解釋： 學生可能誤以為小腸只有吸收，需理解消化作用。" },
      { question: "食物的吸收主要在哪個器官進行？", answer: "小腸的迴腸。\n\n留意大腸的主要功用為吸收淨餘水分。最多的吸收是發生在迴腸，最大部分的水分亦是在迴腸中被吸收的。" },
      { question: "小腸對食物吸收的適應性特徵有哪些？", answer: "小腸很長，增加食物逗留時間。內壁高度摺叠，並有大量絨毛和微絨毛，增加吸收的表面積。小腸壁和微血管很簿（僅由一層上皮細胞組成），能縮短已消化的食物分子的擴散距。有大量的血管和乳糜管存在，能迅速將已吸收的食物運走，保持陡峭的濃度梯度。" },
      { question: "食物吸收後的運輸路徑是什麼？", answer: "水溶性食物經微血管到肝門靜脈運到肝，再經肝靜脈和腔靜脈運回心。脂溶性食物經乳糜管和淋巴管運到腔靜脈，然後運回心。" },
      { question: "什麼是同化？", answer: "同化是細胞攝取並運用已吸收食物分子進行新陳代謝的過程。" },
      { question: "肝臟在營養中的作用是什麼？", answer: "調節血糖、儲存營養素、製造膽汁、脫氨作用、解毒。" }
    ]
    },
    {
      id: "CH7",
      title: "生物記憶卡_CH7 人體的氣體交換",
    flashcards: [
      { question: "人體為何需要呼吸系統？", answer: "生物需要透過呼吸作用釋放葡萄糖中的能量。\n\n解釋: 呼吸系統負責攝取氧氣供呼吸作用，並排出產生的二氧化碳，避免二氧化碳積聚使pH值太低,，影響細胞中的酶運作。" },
      { question: "空氣經鼻孔吸入後，會依序經過哪些呼吸道構造才到達肺部？", answer: "鼻孔 → 鼻腔 → 咽 → 喉 → 氣管 → 支氣管 → 小支氣管 → 氣囊（肺泡）。" },
      { question: "鼻腔有哪些特徵可以幫助潔淨、濕潤和暖化吸入的空氣？", answer: "鼻孔有鼻毛過濾塵埃；鼻腔內壁有黏液黏住並和纖毛上皮細胞透過擺動掃走塵埃微生物，同時濕潤空氣；內壁有大量血管暖化空氣。" },
      { question: "鼻腔內的纖毛擺動方向是朝哪裡？有什麼作用？", answer: "纖毛向咽喉方向擺動。\n\n解釋: 將黏住塵埃和微生物的黏液掃向咽，隨後被咳出或吞下，以潔淨呼吸道。" },
      { question: "吞嚥時，會厭如何防止食物誤入呼吸道？", answer: "吞嚥時喉會被升起，壓向會厭。\n\n解釋: 使會厭蓋住喉的開口，防止食團進入氣管，避免窒息。" },
      { question: "喉部的哪一部分負責發出聲音？其原理是什麼？", answer: "喉部內的聲帶。\n\n解釋: 當空氣流經兩片聲帶時，會使聲帶振動，產生聲音。" },
      { question: "氣管和支氣管管壁中的「C形軟骨」有什麼重要功能？", answer: "軟骨能提供支撐。\n\n解釋: 防止氣管和支氣管在呼吸時因氣壓改變而塌陷，確保氣流順暢。" },
      { question: "肺周圍的「胸膜」有何功能？", answer: "內胸膜附在肺外表面，外胸膜附在胸腔內壁。\n\n解釋: 兩層胸膜之間的胸膜液能固定胸膜，並作為潤滑劑減少呼吸時的摩擦。" },
      { question: "什麼是「氣胸」？為何它會導致肺部塌縮？", answer: "氣胸是指胸膜破裂，空氣進入胸膜腔。\n\n解釋: 正常胸膜腔內呈負壓，空氣流入後負壓消失，肺部會因其自身彈性而塌縮。" },
      { question: "氣囊在肺部扮演了什麼角色？", answer: "氣囊是肺內進行氣體交換的主要呼吸表面。" },
      { question: "氣囊數量龐大，這對氣體交換有何好處？", answer: "大量氣囊可提供非常大的表面積，大大提高氣體擴散的效率。" },
      { question: "為什麼氣囊壁只有一層細胞厚？", answer: "這可大大縮短氣體（氧氣和二氧化碳）從氣囊到血液或從血液到氣囊的擴散距離，加快氣體交換的速度。" },
      { question: "氣囊內壁為何需要保持濕潤？", answer: "氧氣必須先溶解在氣囊內壁表面的薄水膜中，才能藉擴散作用進入血液。濕潤的表面能確保氧氣順利溶解。" },
      { question: "氣囊外為何佈滿微血管？這對氣體交換有何幫助？", answer: "大量微血管能迅速運走已攝取氧氣的血液，並運來缺氧血，從而維持氣囊與血液之間陡峭的氣體濃度梯度，加速氣體擴散。" },
      { question: "氧氣從氣囊進入血液的過程是怎樣的？", answer: "氣囊中的氧氣溶解在氣囊內壁的薄水膜中，由於薄水膜的氧濃度較缺氧血高，溶解氧藉擴散作用穿過氣囊壁和微血管壁進入血液。" },
      { question: "二氧化碳從血液排出氣囊的過程是怎樣的？", answer: "缺氧血的二氧化碳濃度較氣囊內壁的薄水膜高，血液內的二氧化碳藉擴散作用穿過微血管壁和氣囊壁，進入氣囊內的空氣中，最終隨呼氣離開身體。" },
      { question: "紅血細胞如何適應氧氣的轉運？", answer: "紅血細胞充滿血紅蛋白（極佳的氧載體）；成熟後沒有細胞核，提供更多空間容納血紅蛋白；呈雙凹圓盤狀，增加表面積與體積比，縮短擴散距離。這些特徵使其高效運氧。" },
      { question: "氧氣在血液中主要以什麼形式轉運？", answer: "大部分氧氣與紅血細胞中的血紅蛋白結合，形成氧合血紅蛋白。\n\n解釋: 少量溶解在血漿中。" },
      { question: "為什麼氧合血紅蛋白在肺部形成，但在身體組織中會分解為氧和血紅蛋白？", answer: "在肺部，氧濃度高，氧氣與血紅蛋白結合。在身體組織中，氧濃度低（因體細胞消耗氧氣），氧合血紅蛋白會分解，釋放氧氣供體細胞使用。" },
      { question: "二氧化碳在血液中主要以什麼形式轉運？", answer: "大部分二氧化碳以碳酸氫鹽離子的形式轉運於血漿中。少量與血紅蛋白結合，也有少量溶解在血漿中。" },
      { question: "為什麼一氧化碳對人體有劇毒？", answer: "一氧化碳與血紅蛋白的結合能力比氧氣強約200倍。\n\n解釋: 一旦吸入，一氧化碳會優先與血紅蛋白結合，減少血液攜帶氧氣的能力，導致細胞缺氧，嚴重時可致命。" },
      { question: "哮喘發作時，為什麼氣體交換效率會下降？", answer: "哮喘發作時，小支氣管收縮，導致進入氣囊的空氣減少。\n\n解釋: 降低氣囊與血液之間的氣體濃度梯度，氣體交換效率因此下降。" },
      { question: "吸煙如何損害呼吸系統？", answer: "香煙中的化學物質會破壞纖毛，刺激過量黏液分泌，導致呼吸道變窄；焦油會沉積在氣囊表面，減少呼吸表面積；還可能引致肺癌和肺氣腫。\n\n解釋: 吸煙對呼吸系統的危害極大。" },
      { question: "呼吸系統的主要功能是什麼？", answer: "進行氣體交換。\n\n解釋: 吸入氧氣，呼出二氧化碳。這是細胞維持活動的基礎。" },
      { question: "氣管為什麼有C形軟骨？", answer: "支撐氣管。\n\n解釋: 並允許食道擴張。C形設計兼顧呼吸與吞嚥。" },
      { question: "氣囊有哪些特徵適應氣體交換？", answer: "氣囊數量多，增加氣體交換的表面積。氣囊壁和微血壁很薄，只有一層上皮細胞，能縮短擴散距離。氣囊表面濕潤，能容許氣體先溶解然後再擴散至血液。有大量微血管包圍氣囊，迅速運走氣體，維持氣囊和血液中的濃度梯度保持陡峭。這些特徵提高交換效率。" },
      { question: "為什麼氣體交換在氣囊發生？", answer: "氣囊壁薄且表面積大。靠近微血管。這加速氧氣與二氧化碳交換。" },
      { question: "氧氣如何進入血液？", answer: "從氣囊擴散穿過壁進入微血管。濃度差異驅動擴散發生。" },
      { question: "血紅蛋白如何幫助運輸氧？", answer: "與氧結合形成氧合血紅蛋白。" },
      { question: "二氧化碳主要以什麼形式運輸？", answer: "碳酸氫鹽離子。" },
      { question: "為什麼氮氣含量不變？", answer: "身體不消耗或產生氮氣。" },
      { question: "講出吸氣的機制。", answer: "肋間肌收縮，肋骨籃向上和向外移動。橫膈膜肌肉收縮，所以橫膈膜被拉平。胸腔體積上升。肺內的氣壓下降至比大氣壓力低。\n\n解釋: 空氣進入肺。" },
      { question: "講出呼氣的機制。", answer: "肋間肌放鬆，肋骨籃向下和向內移動。橫膈膜肌肉放鬆，所以橫膈膜回復拱形。胸腔體積下降。肺內的氣壓增加至比大氣壓力高。\n\n解釋: 空氣排出肺外。" },
      { question: "呼吸時肺內氣壓如何變化？", answer: "吸氣時下降，呼氣時上升。\n\n解釋: 氣壓差推動空氣流動。" },
      { question: "肺部體積與氣壓關係是什麼？", answer: "體積增加氣壓降，體積減小氣壓升。" },
      { question: "小支氣管為什麼沒軟骨？", answer: "它們夠細，不需額外支撐。" },
      { question: "紅血細胞為什麼沒細胞核？", answer: "留空間給更多血紅蛋白。它是極佳的氧載體。" },
      { question: "二氧化碳如何離開體細胞？", answer: "擴散進入血液。" },
      { question: "為什麼呼出空氣較暖？", answer: "血液溫暖了空氣。" },
      { question: "吸氣時胸腔氣壓為何先跌後升？", answer: "體積增加大使氣壓下降。空氣因而進入肺部使氣壓增加。" },
      { question: "呼氣時胸腔氣壓為何先升後跌？", answer: "體積減少大使氣壓增加。空氣因而離開肺部使氣壓減少。" }
    ]
    },
    {
    id: "CH8",
    title: "生物記憶卡_CH8 人體內物質的轉運",
    flashcards: [
      { question: "人的運送系統包括哪些部分？", answer: "循環系統和淋巴系統。\n\n解釋: 這兩個系統共同負責人體內物質的轉運。" },
      { question: "循環系統的三大組成單位是什麼？", answer: "血液、血管和心臟。\n\n解釋: 這是物質轉運的核心結構，缺一不可。" },
      { question: "血漿由哪些成分組成？", answer: "水、血漿蛋白、營養素、激素、廢物和氣體。\n\n解釋: 血漿是血液的液體部分，負責運輸多種物質。" },
      { question: "紅血細胞為什麼呈雙凹圓盤形？", answer: "增加表面積與體積比，縮短氣體的擴散距離。" },
      { question: "白血細胞分為哪兩大類？", answer: "淋巴細胞和吞噬細胞。\n\n解釋: 它們在免疫系統中分工合作，對抗病原體，淋巴細胞會釋放抗體消滅病原體，吞噬細胞則會以吞噬作用消滅病原體。" },
      { question: "動脈和靜脈的血流方向有何不同？", answer: "動脈的血液離開心臟，靜脈的血液回到心臟。" },
      { question: "動脈壁為什麼比靜脈壁厚？", answer: "承受更高的血壓(動脈的血直接從心泵出，壓力較高)。" },
      { question: "微血管的管壁有什麼特點？", answer: "微血管的管壁很簿，由一層上皮細胞組成，具差異透性，容許物質交換發生。其他動脈和靜脈不具透性，故絕不能進行物質交換解釋: 微血管的薄壁縮短擴散距離，提高擴散效率。" },
      { question: "靜脈中的瓣膜有什麼作用？", answer: "防止血液倒流。\n\n解釋: 確保血液單向流回心臟。" },
      { question: "心臟瓣膜的功能是什麼？", answer: "保證血液單向流動，防止血液從心室倒流至心房，維持循環順暢。" },
      { question: "左心室壁比右心室壁厚的原因是什麼？", answer: "需泵血至全身，壓力更大。\n\n解釋: 左心室泵血距離和所需壓力遠大於右心室。" },
      { question: "冠狀動脈有什麼作用？", answer: "供應心肌氧氣和營養。\n\n解釋: 心臟自身也需要血液滋養才能正常運作。" },
      { question: "雙循環系統包括哪兩種循環？", answer: "肺循環和體循環。\n\n解釋: 肺循環負責氣體交換，體循環負責供應全身。" },
      { question: "為什麼動脈中的血壓較靜脈高？", answer: "動脈直接接受心臟泵壓，心臟泵壓是動脈中，血液流動的動力來源。" },
      { question: "微血管中血壓為何大幅下降？", answer: "管徑小，阻力大。\n\n解釋: 減慢血流，利於物質交換。" },
      { question: "組織液是怎樣形成的？", answer: "近動脈的微血管床的血液壓大於體細胞間液體的壓力。除血漿蛋白、血紅細胞和血小板外（體積太大），其他血漿成分被逼出微血管壁，進入細胞間隙，形成組織液。" },
      { question: "組織液如何回到血液？", answer: "大部分經靜脈回收，少部分經淋巴系統。血漿蛋白留在微血管中，使微血管血液的水勢低於近靜脈的組織液水勢組織液中的大部分的水藉滲透進入微血管。另外，組織液的流體靜壓比淋巴微管中液體高，所以進入淋巴微管。" },
      { question: "淋巴結的功能是什麼？", answer: "過濾病原體。\n\n解釋: 是免疫防線的重要部分。" },
      { question: "淋巴管為什麼有瓣膜？", answer: "防止淋巴液倒流，確保淋巴液單向流動。" },
      { question: "動脈一定攜帶含氧血嗎？", answer: "否，例如肺動脈攜帶缺氧血。\n\n解釋: 動脈定義是離心血管，而非含氧血。" },
      { question: "靜脈一定攜帶缺氧血嗎？", answer: "否，例如肺靜脈攜帶含氧血。\n\n解釋: 靜脈定義是回心血管。" },
      { question: "微血管的作用是什麼？", answer: "連接動脈和靜脈，進行物質交換。\n\n解釋: 是血液與組織間的橋樑。" },
      { question: "血壓在血管中如何變化？", answer: "動脈最高，微血管下降，靜脈最低。\n\n解釋: 血壓梯度驅動血液流動。" },
      { question: "組織液和血漿有什麼區別？", answer: "組織液無紅血細胞和血漿蛋白。\n\n解釋: 因大分子無法滲出微血管。" },
      { question: "高血壓為什麼可能引起水腫？", answer: "組織液形成增多，回收速度不足的話，組織液會因而積聚。" },
      { question: "冠狀動脈阻塞會有什麼後果？", answer: "心肌缺氧。\n\n解釋: 可能引發心肌梗塞。心臟供血不足的嚴重結果。" },
      { question: "對於體型較大的多細胞生物，為什麼不能只靠擴散來運送體內物質？", answer: "體型較大的生物，細胞與細胞之間相距很遠。\n\n解釋: 單靠擴散來運送物質效率太低，無法確保有用物質及時送達所有細胞，也無法迅速移除廢物。" },
      { question: "血液經離心機處理後會分成哪兩層？各自約佔體積的多少？", answer: "血液會分成上層淡黃色的血漿（約佔體積的55%）和下層深紅色的血細胞（約佔體積的45%）。\n\n解釋: 這是血液的主要組成部分。" },
      { question: "血漿的主要成分是什麼？除了水還溶解了哪些重要物質？", answer: "血漿的主要成分是水（佔90%），其中溶解了多種可溶物質。\n\n解釋: 包括二氧化碳、營養素（如葡萄糖、氨基酸）、尿素、激素、抗體和纖維蛋白原等。" },
      { question: "血漿除了運送物質外，還有什麼重要功能？", answer: "血漿能把熱量分佈到全身。\n\n解釋: 以幫助身體維持恆定體溫。" },
      { question: "紅血細胞呈雙凹圓盤狀且成熟後沒有細胞核，這對其功能有何適應性？", answer: "雙凹圓盤狀能增加表面積與體積比，縮短氣體擴散距離；沒有細胞核則能提供更多空間容納血紅蛋白。\n\n解釋: 提高攜氧能力。" },
      { question: "為什麼紅血細胞含有血紅蛋白，但白血細胞和血小板沒有顏色？", answer: "紅血細胞含有紅色的血紅蛋白色素，負責攜帶氧氣。\n\n解釋: 白血細胞和血小板不含血紅蛋白，所以沒有顏色。" },
      { question: "血紅蛋白在肺部和身體組織中，與氧氣的結合情況有何不同？", answer: "在肺部，氧濃度高，氧氣與血紅蛋白結合形成氧合血紅蛋白。\n\n解釋: 在身體組織中，氧濃度低，氧合血紅蛋白會分解釋放氧氣供體細胞使用。" },
      { question: "白血細胞主要有哪兩種？它們在抵抗疾病方面各扮演什麼角色？", answer: "白血細胞主要有吞噬細胞和淋巴細胞。\n\n解釋: 吞噬細胞能吞噬並消化入侵的病菌；淋巴細胞則產生抗體，幫助殺死病菌或中和其毒素。" },
      { question: "貧血與白血病患者的血塗片有何典型差異？", answer: "貧血患者的血塗片顯示紅血細胞數量較正常低。\n\n解釋: 白血病患者的血塗片則顯示白血細胞數量較正常多且異常。" },
      { question: "動脈、靜脈和微血管在血液流動方向上的定義是什麼？", answer: "動脈是把血液從心臟帶到組織的血管。靜脈是把血液從組織帶回心臟的血管。\n\n解釋: 微血管則連接動脈與靜脈，是物質交換的場所。" },
      { question: "肺動脈和肺靜脈攜帶的血液性質（含氧或缺氧）與其他動脈、靜脈有何不同？", answer: "肺動脈是動脈中攜帶缺氧血的血管，它將缺氧血從心臟送到肺部。\n\n解釋: 肺靜脈是靜脈中攜帶含氧血的血管，它將含氧血從肺部送回心臟。" },
      { question: "動脈管壁與靜脈管壁相比，有何結構差異？這些差異如何適應其功能？", answer: "動脈管壁較厚，能承受心臟泵血產生的高血壓。富含彈性組織，能藉反衝推動血液。含肌肉層以調節血流份量。\n\n解釋: 靜脈管壁較薄，彈性組織和肌肉較少，管腔較大，以減低血液流動阻力。" },
      { question: "為什麼靜脈內有瓣膜，而動脈通常沒有（除了心臟出口處）？", answer: "靜脈內的血液壓力較低，且流回心臟需要克服地心引力。\n\n解釋: 瓣膜能防止血液倒流，確保血液單向流動回心臟。動脈血壓高，不需要瓣膜防止倒流。" },
      { question: "什麼是「微血管床」？它的結構特徵如何適應物質交換？", answer: "微血管床是小動脈分支成的大量微血管網絡，包圍著身體組織。其特徵包括：高度分支（提供巨大表面積進行物質交換）、管壁只有一層細胞厚（縮短擴散距離）、血液流動緩慢（提供足夠時間進行物質交換）。" },
      { question: "為什麼微血管的管腔直徑很小，只能讓一個紅血細胞通過？", answer: "小管腔能讓紅血細胞緊貼微血管壁。\n\n解釋: 縮短氧氣和二氧化碳的擴散距離，提高氣體交換效率。" },
      { question: "哪種血管能調節到達器官的血流量？它是如何實現的？", answer: "小動脈。\n\n解釋: 其肌肉層的收縮或放鬆能改變管腔的大小，從而調節進入微血管床的血流量。微血管本身不能收縮或擴張。" },
      { question: "血液流經血管時，血壓和血流速度在動脈、微血管和靜脈之間有何變化趨勢？", answer: "血壓在動脈中最高，隨後在微血管中急劇下降，在靜脈中最低。\n\n解釋: 血流速度在動脈中高，在微血管中最低，而在靜脈中因骨骼肌收縮推動而略有增加。" },
      { question: "為什麼血液在微血管中的流動速度最慢？這有何生物學意義？", answer: "儘管單條微血管管腔狹窄，但微血管床的總橫切面面積是循環系統中最大的。\n\n解釋: 這種巨大的總面積導致血液流動速度降低，為血液與體細胞之間進行物質交換提供了足夠的時間。" },
      { question: "除了心臟的泵壓，靜脈中的血液流動主要靠什麼力量推動？", answer: "靜脈內的血液流動主要依靠靜脈旁邊骨骼肌的收縮。\n\n解釋: 當骨骼肌收縮時，會擠壓靜脈，推動血液流回心臟。" }
    ]
    }
  ];
  // 狀態管理：每章節各自維護學習狀態
  const stateByChapter = {};
  function initChapterState(chapterId){
    const chapter = chapters.find(c=>c.id===chapterId);
    stateByChapter[chapterId] = {
      cardsWithWeights: chapter.flashcards.map(c => ({ ...c, weight: 1, hardCount: 0 })),
      currentIndex: 0, flipped: false, flipping: false, history: [0], historyPos: 0
    };
  }
  chapters.forEach(ch => initChapterState(ch.id));
  
  // 目前章節 & 主題
  let currentChapterId = "CH5";
  const themes = ['', 'theme-ocean-blue', 'theme-sunset-glow', 'theme-forest-green'];
  let currentThemeIndex = 0;

  // UI 元素
  const docElem = document.documentElement;
  const headerTitle = document.getElementById('headerTitle');
  const chapterInfo = document.getElementById('chapterInfo');
  const tabs = Array.from(document.querySelectorAll('.tab'));
  const card = document.getElementById('card');
  const cardFront = document.getElementById('cardFront');
  const cardBack = document.getElementById('cardBack');
  const cardNumber = document.getElementById('cardNumber');
  const flipBtn = document.getElementById('flipBtn');
  const hardBtn = document.getElementById('hardBtn');
  const mediumBtn = document.getElementById('mediumBtn');
  const easyBtn = document.getElementById('easyBtn');
  const prevBtn = document.getElementById('prevBtn');
  const summaryBtn = document.getElementById('summaryBtn');
  const summaryBlock = document.getElementById('summaryBlock');
  const themeBtn = document.getElementById('themeBtn');

  function getChapter(){ return chapters.find(c=>c.id===currentChapterId); }
  function getState(){ return stateByChapter[currentChapterId]; }
  
  function updateHeader(){
    const ch = getChapter();
    headerTitle.textContent = ch.title;
    document.title = ch.title;
    chapterInfo.textContent = `目前章節：${ch.id}`;
  }
  
  function renderCard() {
    const cardContainer = document.querySelector('.card-container');
    cardContainer.style.animation = 'none';
    void cardContainer.offsetHeight; // 觸發瀏覽器重繪 (reflow)
    cardContainer.style.animation = '';

    const st = getState();
    st.flipped = false;
    card.classList.remove("flipped");
    card.setAttribute("aria-pressed", "false");
    const item = st.cardsWithWeights[st.currentIndex];
    cardFront.textContent = item.question;
    cardBack.textContent = item.answer;
    cardNumber.textContent = `卡片 ${st.currentIndex + 1} / ${st.cardsWithWeights.length}`;
    prevBtn.disabled = (st.historyPos <= 0);
    summaryBlock.hidden = true;
    summaryBlock.innerHTML = "";
  }
  
  function flipCard() {
    const st = getState();
    if (st.flipping) return;
    st.flipping = true;
    st.flipped = !st.flipped;
    card.classList.toggle("flipped", st.flipped);
    card.setAttribute("aria-pressed", st.flipped ? "true" : "false");
    setTimeout(() => { st.flipping = false; }, 600);
  }
  
  function updateWeight(difficulty) {
    const st = getState();
    const cardObj = st.cardsWithWeights[st.currentIndex];
    if (difficulty === "hard") { cardObj.weight += 2; cardObj.hardCount++; }
    else if (difficulty === "medium") { /* 不變 */ }
    else if (difficulty === "easy") { cardObj.weight = Math.max(1, cardObj.weight - 1); }
  }
  
  function weightedRandomIndex() {
    const st = getState();
    const totalWeight = st.cardsWithWeights.reduce((sum, c) => sum + c.weight, 0);
    if (totalWeight <= 0) return 0;
    let r = Math.random() * totalWeight;
    for (let i = 0; i < st.cardsWithWeights.length; i++) {
      r -= st.cardsWithWeights[i].weight;
      if (r < 0) return i;
    }
    return 0;
  }
  
  function nextCard(difficulty) {
    const st = getState();
    updateWeight(difficulty);
    const nextIdx = weightedRandomIndex();
    st.currentIndex = nextIdx;
    if (st.historyPos < st.history.length - 1) {
      st.history = st.history.slice(0, st.historyPos + 1);
    }
    st.history.push(st.currentIndex);
    st.historyPos++;
    renderCard();
    saveProgress();
  }
  
  function prevCard() {
    const st = getState();
    if (st.historyPos <= 0) return;
    st.historyPos--;
    st.currentIndex = st.history[st.historyPos];
    renderCard();
  }
  
  function showHardSummary() {
    const st = getState();
    let sortedCards = [...st.cardsWithWeights]
      .filter(c => c.hardCount > 0)
      .sort((a,b) => b.hardCount - a.hardCount)
      .slice(0,5);
    if (sortedCards.length === 0) {
      summaryBlock.innerHTML = "<h3>尚無標記為困難的題目</h3>";
      summaryBlock.hidden = false;
      return;
    }
    let html = "<h3>困難題目小結（前5題）</h3>";
    sortedCards.forEach((c,i) => {
      html += `<div class="summary-item">
        <p><strong>題目 ${i + 1}：</strong>${c.question}</p>
        <p><strong>答案：</strong>${c.answer}</p>
        <p><strong>困難標記次數：</strong>${c.hardCount}</p>
      </div>`;
    });
    summaryBlock.innerHTML = html;
    summaryBlock.hidden = false;
  }
  
  function switchChapter(newId){
    if (newId === currentChapterId) return;
    tabs.forEach(t=>{
      const active = t.dataset.chapter === newId;
      t.classList.toggle('active', active);
      t.setAttribute('aria-pressed', active ? 'true' : 'false');
    });
    currentChapterId = newId;
    updateHeader();
    renderCard();
    card.focus();
    saveProgress();
  }
  
// =================================================
// 初始設定與渲染
// =================================================

loadProgressAndSettings(); // <-- 新增：在渲染前，先讀取儲存的進度與設定

  updateHeader();
  renderCard();
  
  // 事件綁定
  flipBtn.addEventListener("click", flipCard);
  hardBtn.addEventListener("click", () => { const st = getState(); if (!st.flipped) flipCard(); nextCard("hard"); });
  mediumBtn.addEventListener("click", () => { const st = getState(); if (!st.flipped) flipCard(); nextCard("medium"); });
  easyBtn.addEventListener("click", () => { const st = getState(); if (!st.flipped) flipCard(); nextCard("easy"); });
  prevBtn.addEventListener("click", prevCard);
  summaryBtn.addEventListener("click", showHardSummary);
  
  themeBtn.addEventListener('click', () => {
    currentThemeIndex = (currentThemeIndex + 1) % themes.length;
    const newTheme = themes[currentThemeIndex];
    docElem.className = newTheme;
    saveProgress();
  });

  document.addEventListener("keydown", (e) => {
    if ((e.code === "Space" || e.key === " ") && document.activeElement === card) {
      e.preventDefault(); flipCard(); return;
    }
    if (e.key === "1") { const st=getState(); if(!st.flipped) flipCard(); nextCard("hard"); }
    if (e.key === "2") { const st=getState(); if(!st.flipped) flipCard(); nextCard("medium"); }
    if (e.key === "3") { const st=getState(); if(!st.flipped) flipCard(); nextCard("easy"); }
    if (e.key === "ArrowLeft") { prevCard(); }
    if (e.key?.toLowerCase?.() === "s") { showHardSummary(); }
  });
  
  card.addEventListener('click', flipCard);
  tabs.forEach(tab => tab.addEventListener('click', () => switchChapter(tab.dataset.chapter)));
  
  // 為了簡化，我移除了之前版本中 chapters 資料的省略部分，將完整的資料放入
  // 這確保了程式碼的完整性和可運行性
</script>
</body>
</html>
